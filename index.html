<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chess App - Play & Learn</title>
</head>
<body>
  <div id="app">
    <!-- Landing Page / Mode Selection -->
    <div id="landing-page">
      <h1>Chess Application</h1>
      <div id="mode-selection">
        <button id="select-play" class="mode-select-btn">
          <div class="mode-icon">‚ôî</div>
          <h2>Play Chess</h2>
          <p>Play against another player or AI</p>
        </button>
        <button id="select-openings" class="mode-select-btn">
          <div class="mode-icon">üìö</div>
          <h2>Opening Repository</h2>
          <p>Study and practice chess openings</p>
        </button>
        <button id="select-endgames" class="mode-select-btn">
          <div class="mode-icon">üéØ</div>
          <h2>Endgame Training</h2>
          <p>Master classic endgame positions</p>
        </button>
        <button id="select-tactical" class="mode-select-btn">
          <div class="mode-icon">‚ö°</div>
          <h2>Tactical Puzzles</h2>
          <p>Sharpen your tactical vision</p>
        </button>
      </div>
    </div>

    <!-- Play Chess Mode -->
    <div id="play-container" class="hidden">
      <div class="page-header">
        <button id="back-from-play" class="btn-back">‚Üê Back to Menu</button>
        <h1>Play Chess</h1>
      </div>
      <!-- Game Setup Panel -->
      <div id="setup-panel">
        <div class="setup-section">
          <h3>Game Mode</h3>
          <div class="radio-group">
            <label>
              <input type="radio" name="game-mode" value="pvp" checked>
              Human vs Human
            </label>
            <label>
              <input type="radio" name="game-mode" value="ai">
              Human vs AI
            </label>
          </div>
        </div>

        <div id="ai-settings" class="setup-section" style="display: none;">
          <h3>AI Settings</h3>
          <div class="form-group">
            <label for="player-color">Play as:</label>
            <select id="player-color">
              <option value="white">White</option>
              <option value="black">Black</option>
            </select>
          </div>
          <div class="form-group">
            <label for="ai-difficulty">AI Difficulty:</label>
            <select id="ai-difficulty">
              <option value="1">Very Easy (1)</option>
              <option value="3">Easy (3)</option>
              <option value="5">Beginner (5)</option>
              <option value="8">Intermediate (8)</option>
              <option value="12">Advanced (12)</option>
              <option value="15">Expert (15)</option>
              <option value="18">Master (18)</option>
              <option value="20" selected>Maximum (20)</option>
            </select>
          </div>
        </div>

        <div class="setup-section">
          <h3>Starting Position</h3>
          <div class="form-group">
            <label>
              <input type="radio" name="position-mode" value="standard" checked>
              Standard Position
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="radio" name="position-mode" value="fen">
              From FEN String
            </label>
          </div>
          <div id="fen-input-group" class="form-group" style="display: none;">
            <input type="text" id="fen-input" placeholder="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1">
            <small>Enter a valid FEN string</small>
          </div>
          <div class="form-group">
            <label>
              <input type="radio" name="position-mode" value="pgn">
              From PGN
            </label>
          </div>
          <div id="pgn-input-group" class="form-group" style="display: none;">
            <textarea id="pgn-input" rows="4" placeholder="1. e4 e5 2. Nf3 Nc6..."></textarea>
            <small>Paste PGN and the game will be loaded to the last move</small>
          </div>
        </div>

        <button id="start-game" class="btn-primary">Start Game</button>
        <button id="reset-game" class="btn-secondary" style="display: none;">New Game</button>
      </div>

      <div id="game-container" style="display: none;">
        <div id="board-and-moves">
          <div id="board-wrapper">
            <canvas id="chess-board"></canvas>
            <div id="board-controls">
              <div id="board-control-buttons">
                <button id="flip-board-btn" class="control-btn-small" title="Flip board">üîÑ Flip</button>
                <div id="board-size-control">
                  <label for="board-size-slider" title="Board size">üìê</label>
                  <input type="range" id="board-size-slider" min="320" max="800" value="640" step="20">
                  <span id="board-size-display">640px</span>
                </div>
              </div>
              <div id="move-navigation">
                <button id="nav-start" class="nav-btn" title="Go to start">‚èÆ</button>
                <button id="nav-prev" class="nav-btn" title="Previous move">‚óÄ</button>
                <button id="nav-next" class="nav-btn" title="Next move">‚ñ∂</button>
                <button id="nav-end" class="nav-btn" title="Go to end">‚è≠</button>
              </div>
            </div>
          </div>
          <div id="move-history-sidebar">
            <h3>Move History</h3>
            <div id="moves-list"></div>
          </div>
        </div>
        <div id="game-info">
          <div id="turn-indicator"></div>
          <div id="game-status"></div>
          <div id="ai-thinking" style="display: none;">
            <span class="spinner"></span> AI is thinking...
          </div>
        </div>
      </div>
    </div>

    <!-- Opening Repository Mode -->
    <div id="openings-container" class="hidden">
      <div class="page-header">
        <button id="back-from-openings" class="btn-back">‚Üê Back to Menu</button>
        <h1>Opening Repository</h1>
      </div>
      <div id="openings-layout">
        <div id="opening-board-wrapper">
          <canvas id="opening-board"></canvas>
          <div id="opening-board-controls">
            <div id="opening-board-control-buttons">
              <button id="opening-flip-board-btn" class="control-btn-small" title="Flip board">üîÑ Flip</button>
              <div id="opening-board-size-control">
                <label for="opening-board-size-slider" title="Board size">üìê</label>
                <input type="range" id="opening-board-size-slider" min="320" max="800" value="640" step="20">
                <span id="opening-board-size-display">640px</span>
              </div>
            </div>
          </div>
        </div>
        <div id="openings-panel">

          <!-- Repository Management -->
          <div id="repository-container">
            <h2>Opening Repository</h2>
            <div id="repository-actions">
              <button id="btn-new-opening" class="btn-primary">New Opening</button>
              <button id="btn-import-pgn" class="btn-secondary">Import PGN</button>
              <button id="btn-practice" class="btn-primary">Practice</button>
            </div>
            <div id="repository-stats"></div>
            <div id="opening-list"></div>
            <div id="data-actions">
              <button id="btn-export-json" class="btn-small">Export All (JSON)</button>
              <button id="btn-import-json" class="btn-small">Import JSON</button>
            </div>
          </div>

          <!-- Input Mode -->
          <div id="input-container" class="hidden">
            <h2>Input Mode</h2>
            <div id="input-info">
              <h3 id="input-opening-name"></h3>
              <p class="instruction">Click pieces to add moves to your opening</p>
            </div>
            <div id="input-moves">
              <strong>Moves:</strong>
              <div id="input-move-list"></div>
            </div>
            <div id="input-tree-view-scroll">
              <div id="input-tree-view"></div>
            </div>
            <div id="input-actions">
              <button id="btn-mark-key-position" class="btn-secondary">‚òÜ Mark as Key</button>
              <button id="btn-reset-input" class="btn-secondary">Reset</button>
              <button id="btn-view-mode" class="btn-secondary">View Tree</button>
              <button id="btn-repository" class="btn-secondary">Back</button>
            </div>
          </div>

          <!-- View Mode -->
          <div id="view-container" class="hidden">
            <h2>Tree View</h2>
            <div id="tree-view-scroll">
              <div id="tree-view"></div>
            </div>
            <div id="view-actions">
              <button id="btn-input-mode" class="btn-secondary">Input Mode</button>
              <button id="btn-repository-from-view" class="btn-secondary">Back</button>
            </div>
          </div>

          <!-- Practice Mode -->
          <div id="practice-container" class="hidden">
            <h2>Practice Mode</h2>
            <div id="practice-info">
              <div id="practice-question"></div>
              <div id="practice-instruction">Find the best move!</div>
            </div>
            <div id="practice-result"></div>
            <div id="quality-buttons" class="hidden">
              <p><strong>How well did you remember?</strong></p>
              <div id="quality-grid">
                <button id="btn-quality-0" class="quality-btn" data-quality="0">0 - Complete blackout</button>
                <button id="btn-quality-1" class="quality-btn" data-quality="1">1 - Incorrect</button>
                <button id="btn-quality-2" class="quality-btn" data-quality="2">2 - Incorrect, felt familiar</button>
                <button id="btn-quality-3" class="quality-btn" data-quality="3">3 - Correct, difficult</button>
                <button id="btn-quality-4" class="quality-btn" data-quality="4">4 - Correct, hesitation</button>
                <button id="btn-quality-5" class="quality-btn" data-quality="5">5 - Perfect!</button>
              </div>
            </div>
            <div id="practice-actions">
              <button id="btn-show-answer" class="btn-secondary">Show Answer</button>
              <button id="btn-next-position" class="btn-secondary">Skip</button>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Endgame Training Mode -->
    <div id="endgames-container" class="hidden">
      <div class="page-header">
        <button id="back-from-endgames" class="btn-back">‚Üê Back to Menu</button>
        <h1>Endgame Training</h1>
      </div>

      <!-- Puzzle Selection -->
      <div id="puzzle-selection">
        <div id="puzzle-selector-container"></div>
      </div>

      <!-- Puzzle Play Mode -->
      <div id="puzzle-game" class="hidden">
        <button id="back-to-puzzles" class="btn-back">‚Üê Back to Puzzles</button>
        <div id="puzzle-container">
          <div id="puzzle-board-wrapper">
            <canvas id="puzzle-board"></canvas>
            <div id="puzzle-board-controls">
              <div id="puzzle-board-control-buttons">
                <button id="puzzle-flip-board-btn" class="control-btn-small" title="Flip board">üîÑ Flip</button>
                <div id="puzzle-board-size-control">
                  <label for="puzzle-board-size-slider" title="Board size">üìê</label>
                  <input type="range" id="puzzle-board-size-slider" min="320" max="800" value="640" step="20">
                  <span id="puzzle-board-size-display">640px</span>
                </div>
              </div>
            </div>
          </div>
          <div id="puzzle-panel">
            <div id="puzzle-info">
              <h2 id="puzzle-title"></h2>
              <p id="puzzle-description"></p>
              <p class="puzzle-objective" id="puzzle-objective"></p>
            </div>

            <div id="puzzle-feedback" class="feedback"></div>

            <div id="puzzle-controls">
              <button id="hint-button" class="control-btn">üí° Get Hint</button>
              <button id="reset-button" class="control-btn">üîÑ Reset</button>
              <button id="next-puzzle-button" class="control-btn" style="display: none;">‚û°Ô∏è Next Puzzle</button>
            </div>

            <div id="puzzle-hints-section">
              <h3>Hints Used</h3>
              <div id="puzzle-hints"></div>
            </div>

            <div id="move-history-puzzle">
              <h3>Moves</h3>
              <div id="move-list"></div>
            </div>

            <div id="educational" style="display: none;"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tactical Puzzles Mode -->
    <div id="tactical-container" class="hidden">
      <div class="page-header">
        <button id="back-from-tactical" class="btn-back">‚Üê Back to Menu</button>
        <h1>Tactical Puzzles</h1>
      </div>

      <!-- Puzzle Selection -->
      <div id="tactical-puzzle-selection">
        <div id="tactical-puzzle-selector-container"></div>
      </div>

      <!-- Puzzle Play Mode -->
      <div id="tactical-puzzle-game" class="hidden">
        <button id="tactical-back-to-puzzles" class="btn-back">‚Üê Back to Puzzles</button>
        <div id="tactical-puzzle-container">
          <div id="tactical-puzzle-board-wrapper">
            <canvas id="tactical-puzzle-board"></canvas>
            <div id="tactical-puzzle-board-controls">
              <div id="tactical-puzzle-board-control-buttons">
                <button id="tactical-puzzle-flip-board-btn" class="control-btn-small" title="Flip board">üîÑ Flip</button>
                <div id="tactical-puzzle-board-size-control">
                  <label for="tactical-puzzle-board-size-slider" title="Board size">üìê</label>
                  <input type="range" id="tactical-puzzle-board-size-slider" min="320" max="800" value="640" step="20">
                  <span id="tactical-puzzle-board-size-display">640px</span>
                </div>
              </div>
            </div>
          </div>
          <div id="tactical-puzzle-panel">
            <div id="tactical-puzzle-info">
              <h2 id="tactical-puzzle-title"></h2>
              <p id="tactical-puzzle-description"></p>
              <p class="puzzle-objective" id="tactical-puzzle-objective"></p>
            </div>

            <div id="tactical-puzzle-feedback" class="feedback"></div>

            <div id="tactical-puzzle-controls">
              <button id="tactical-hint-button" class="control-btn">üí° Get Hint</button>
              <button id="tactical-reset-button" class="control-btn">üîÑ Reset</button>
              <button id="tactical-next-puzzle-button" class="control-btn" style="display: none;">‚û°Ô∏è Next Puzzle</button>
            </div>

            <div id="tactical-puzzle-hints-section">
              <h3>Hints Used</h3>
              <div id="tactical-puzzle-hints"></div>
            </div>

            <div id="tactical-move-history-puzzle">
              <h3>Moves</h3>
              <div id="tactical-move-list"></div>
            </div>

            <div id="tactical-educational" style="display: none;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script type="module" src="/src/main.ts"></script>
</body>
</html>
